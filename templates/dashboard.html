<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Affiliate Bot Dashboard</title>
<style>
body {
    font-family: 'Arial', sans-serif;
    background: linear-gradient(145deg, #0f0c29, #302b63, #24243e);
    color: #fff;
    margin: 0; padding: 0;
}
header {
    background: #1c1c1c;
    padding: 1rem;
    text-align: center;
    font-size: 1.8rem;
    letter-spacing: 1px;
    border-bottom: 2px solid #ff4081;
}
.container {
    padding: 2rem;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
}
.card {
    background: rgba(255,255,255,0.05);
    border: 1px solid #ff4081;
    border-radius: 15px;
    padding: 1rem;
    text-align: center;
    transition: transform 0.3s;
}
.card:hover { transform: scale(1.05); }
h2 { margin-bottom: 0.5rem; }
.products {
    max-height: 200px;
    overflow-y: auto;
    text-align: left;
}
.products a {
    color: #ff4081;
    text-decoration: none;
    display: block;
    margin-bottom: 0.3rem;
}
.products a:hover { text-decoration: underline; }
</style>
</head>
<body>
<header>✨ Mystical Affiliate Bot Dashboard ✨</header>
<div class="container">
    <div class="card">
        <h2>Last Post</h2>
        <p id="last_post">{{ stats['last_post_time'] or 'Never' }}</p>
    </div>
    <div class="card">
        <h2>Next Post In</h2>
        <p id="next_post">{{ stats['next_post_in'] }} s</p>
    </div>
    <div class="card">
        <h2>Total Clicks</h2>
        <p id="clicks">{{ stats['total_clicks'] }}</p>
    </div>
    <div class="card">
        <h2>Products</h2>
        <div class="products" id="products">
            {% for p in stats['products'] %}
                <a href="{{ p['url'] }}" target="_blank">{{ p['name'] }}</a>
            {% endfor %}
        </div>
    </div>
</div>

<script>
async function refreshStats() {
    const res = await fetch('/api/stats');
    const data = await res.json();
    
    document.getElementById('last_post').innerText = data.last_post_time || 'Never';
    document.getElementById('next_post').innerText = data.next_post_in + ' s';
    document.getElementById('clicks').innerText = data.total_clicks;

    const productsDiv = document.getElementById('products');
    productsDiv.innerHTML = '';
    data.products.forEach(p => {
        const a = document.createElement('a');
        a.href = p.url;
        a.target = '_blank';
        a.innerText = p.name;
        productsDiv.appendChild(a);
    });
}

setInterval(refreshStats, 1000);
</script>
</body>
</html>
