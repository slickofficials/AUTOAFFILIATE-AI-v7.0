<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | SlickOfficials AI v7.7 | $10M Empire</title>
    <meta name="robots" content="noindex, nofollow">
    <link rel="icon" href="/static/favicon.ico">
    <link rel="stylesheet" href="/static/dashboard.css">
</head>
<body>
    <div class="container">
        <h1>AUTOAFFILIATE AI v7.7</h1>
        <p style="text-align:center;font-size:1.1em;margin-bottom:20px;">{{ company }}</p>

        <div class="stat-grid">
            <div class="stat-card"><h3>PLATFORMS</h3><p>X • IG • TikTok • YT</p></div>
            <div class="stat-card"><h3>POSTS SENT</h3><p data-post-count>{{ posts_sent }}</p></div>
            <div class="stat-card"><h3>REFERRALS</h3><p data-referrals>{{ referrals }}</p></div>
            <div class="stat-card"><h3>REF EARNINGS</h3><p data-ref-earnings>₦{{ "%.2f" % ref_earnings }}</p></div>
            <div class="stat-card"><h3>TOTAL REVENUE</h3><p data-revenue>₦{{ "%.2f" % revenue }}</p></div>
        </div>

        <div class="btn-grid">
            <a href="/miniapp" class="btn btn-green">Share Referral Link</a>
            <div class="btn btn-red" onclick="initiatePayout()">WITHDRAW ₦{{ "%.2f" % revenue }}</div>
        </div>

        <div style="text-align:center;">
            <div class="btn btn-red" onclick="launchBeast()" style="display:inline-block;font-size:1.8em;padding:25px 50px;">
                LUNCH BEAST
            </div>
        </div>

        <div class="nav-links">
            <a href="/miniapp" target="_blank">Telegram Mini App</a>
            <a href="/youtube_auth">YouTube Shorts</a>
            <a href="/logout">Logout</a>
        </div>

        <div class="terminal" id="terminal">
            > System idle... Awaiting BEAST activation...
        </div>
    </div>

    <script>
        function launchBeast() {
            const t = document.getElementById('terminal');
            t.innerHTML += "<br>> Initializing LUCK BEAST...<br>> Queueing 500 Shorts...<br>> HeyGen + YouTube ACTIVE<br>> $1M MODE ENGAGED";
            fetch('/beast_campaign').then(r => r.json()).then(d => t.innerHTML += `<br>> ${d.status}`);
        }

        function initiatePayout() {
            const amount = prompt("Amount (₦):", "{{ "%.2f" % revenue }}");
            const bank = prompt("Paystack Recipient Code:");
            if (amount && bank) {
                fetch('/payout', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({amount: parseFloat(amount), bank_account: bank})})
                    .then(r => r.json()).then(d => alert(d.status || d.error));
            }
        }

        // LIVE STATS AUTO-REFRESH
        function refreshStats() {
            fetch('/api/stats').then(r => r.json()).then(data => {
                document.querySelector('[data-post-count]').textContent = data.posts_sent;
                document.querySelector('[data-revenue]').textContent = `₦${data.revenue.toFixed(2)}`;
                document.querySelector('[data-referrals]').textContent = data.referrals;
                document.querySelector('[data-ref-earnings]').textContent = `₦${data.ref_earnings.toFixed(2)}`;
            });
        }
        setInterval(refreshStats, 30000);
        refreshStats();
    </script>
</body>
</html>
